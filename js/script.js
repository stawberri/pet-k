(function(){var e=this;this.puddi=function(t){return e.puddi.mew.push(t)},this.puddi.mew=[],puddi(function(t){e._=t})}).call(this);
(function(){var e="".split,t=[].join;puddi(function(){var i;return i=createjs.Sound,this._registerSound=function(n,a){var r;return r=e.call(n,"."),r.pop(),r=t.call(r,"."),i.registerSound(n,r,void 0,"snd/",a)},this._playSound=function(e){return i.loadComplete(e)?i.play(e):void 0}})}).call(this);
(function(){puddi(function(){function e(e){var t=this;Object.defineProperty(this,"$"+e,{get:function(){return function(e){return null!=e?e:0}(t.$.get(e))},set:function(i){var n;n=parseInt(i,10),isNaN(n)?t.$.del(e):t.$.set(e,n)},configurable:!0,enumerable:!0})}function t(e){var t=this;return Object.defineProperty(this,"$"+e,{get:function(){return t.$.get(e)},set:function(i){null!=i?t.$.set(e,i):t.$.del(e)},configurable:!0,enumerable:!0}),this}var i,n,a,r=[];for(this.$=new Barn(localStorage),i=0,a=(n=["xp","lv","hp","xpTime","overloadTime","lv","mp","recoverTime","tutorial"]).length;a>i;++i)e.call(this,n[i]);for(i=0,a=(n=["xpPassing"]).length;a>i;++i)r.push(t.call(this,n[i]));return r})}).call(this);
(function(){function e(e,t){var i={}.hasOwnProperty;for(var n in t)i.call(t,n)&&(e[n]=t[n]);return e}function t(e){function t(){}return t.prototype=e,new t}puddi(function(){var i,n,a,r,o,l,s,u;for(i=[{xpMin:500,xpPass:1e3,xpMax:3e3,hpGoal:3e3,overloadWait:1e3,cooldown:1e3}],r=[],o=0,l=i.length;l>o;++o)s=o,u=i[o],r.push(n=0===s?u:e(t(n),u));return a=r,this.lv=function(e){return null==e&&(e=this.$lv),a[e]},null==this.lv()?this.$lv=a.length-1:void 0})}).call(this);
(function(){puddi(function(){var e,t,i=this;return this.stage=new createjs.Stage("game"),createjs.Touch.enable(this.stage),e=$.Callbacks("memory unique"),this.tick=function(t){return e.add(t)},t=createjs.Ticker,t.framerate=30,t.timingMode=t.RAF_SYNCHED,t.addEventListener("tick",e.fire),this.tick(function(e){return i.stage.update(e)})})}).call(this);
(function(){puddi(function(){var e,t,i,n,a=this;return e=t=new createjs.Container,e.x=480,e.y=270,this.stage.addChild(t),i=n=new createjs.Bitmap("img/bg/city-water.jpg"),i.regX=640,i.regY=360,t.addChild(n),this.tick(function(){var e,t,i,r;return e=a.$xp,e/=a.lv().xpMax,t=.05*-e+1,i=10*e,i=new createjs.BlurFilter(i,i,1),r=n,r.scaleX=t,r.scaleY=t,r.filters=[i],r.cache(0,0,1280,720),r})})}).call(this);
(function(){puddi(function(){var e,t,i,n,a,r,o,l,s=this;return e=t=new createjs.Sprite(new createjs.SpriteSheet({images:["img/k/0.png","img/k/1.png","img/k/2.png"],frames:{width:368,height:492},animations:{idle:0,alert:1,exclaim:{frames:[2,1,2,1],next:"exclaimAfter"},exclaimAfter:2}})),e.x=69,e.y=49,i=!1,a=$(window),a.on("mousedown touchstart",function(){return i=!0}),a.on("mouseup touchend",function(){return i=!1,n=void 0}),r=0,o=this.stage,o.addChild(t),o.addEventListener("stagemousemove",function(e){var a,o,l;return a=$.now(),i&&a>r&&a>s.$overloadTime&&a>s.$recoverTime?(r=$.now()+50,o=t.globalToLocal(e.stageX,e.stageY),o.hit=t.hitTest(o.x,o.y),(null!=n&&n.hit||o.hit)&&null!=n&&(l=Math.pow(Math.pow(o.x-n.x,2)+Math.pow(o.y-n.y,2),.5),l=Math.ceil(l),s.$xp+=l),n=o):void 0}),l="idle",this.tick(function(e){var i;switch(i=e.timeStamp,l){case"idle":if(s.$xpPassing&&t.gotoAndPlay(l="exclaim"),!(i>s.$recoverTime))return t.gotoAndStop(l="alert");break;case"exclaim":if(s.$xpPassing||t.gotoAndStop(l="idle"),!(i>s.$recoverTime))return t.gotoAndStop(l="alert");break;case"alert":if(i>s.$recoverTime)return t.gotoAndStop(l="idle")}})})}).call(this);
(function(){puddi(function(){var e,t=this;return this._registerSound("xp-fail.mp3",{volume:.3}),this._registerSound("xp-pass.mp3",{volume:.5}),this._registerSound("xp-overload.mp3"),this._registerSound("mp-up.mp3",{volume:.5}),this._registerSound("lv-up.mp3",{volume:.5}),e=function(e,i){switch(null==e&&(e=t.$xp),null==i&&(i=t.lv()),!1){case!(e<i.xpMin):return-1;case!(e<i.xpPass):return 0;case!(e<i.xpMax):return 1;default:return 2}},this.hpGoal=function(){return Math.ceil((1+t.$mp/69)*t.lv().hpGoal)},this.tick(function(i){var n,a;if(n=i.timeStamp-t.$xpTime,n=Math.floor(n),!(1>n)){switch(t.$xp-=n,t.$xp>=0||(t.$xp=0),t.$xpTime=i.timeStamp,a=t.lv(),e(t.$xp,a)){case-1:t.$xpPassing&&(t._playSound("xp-fail"),t.$xpPassing=!1);break;case 0:break;case 1:t.$xpPassing||(t._playSound("xp-pass"),t.$xpPassing=!0);break;case 2:i.timeStamp>t.$overloadTime&&(t._playSound("xp-overload"),t.$xpPassing=!1,t.$overloadTime=i.timeStamp+a.overloadWait*(1+t.$mp/69),t.$xp=0,t.$hp=0)}return t.$xpPassing?t.$hp+=Math.ceil((t.$xp-a.xpMin)*n/(a.xpMax-a.xpMin)):(t.$hp-=Math.ceil((a.xpPass-t.$xp)*n/(a.xpMax-a.xpMin)),t.$hp>=0||(t.$hp=0)),t.$hp>=t.hpGoal()?(t.$xpPassing=!1,t.$xp=0,t.$hp=0,t.$overloadTime=0,function(e){return null!=e}(t.lv(t.$lv+1))?(t._playSound("lv-up"),t.$mp=0,t.$lv++):(t._playSound("mp-up"),t.$mp++),t.$recoverTime=i.timeStamp+t.lv().cooldown*(1+t.$mp/69)):void 0}})})}).call(this);
(function(){puddi(function(){var e,t,i,n,a,r,o,l,s,u,c,p,d=this;return e=t=new createjs.Container,e.x=700,e.y=380,i=(n=new createjs.Shape).graphics,i.setStrokeStyle(5),i.beginStroke("rgba(32, 32, 32, 1)"),i.beginFill("rgba(32, 32, 32, 0.5)"),i.drawCircle(0,0,120),a=(r=new createjs.Shape).graphics,a.setStrokeStyle(3),o=a.beginStroke("rgba(128, 128, 128, 1)").command,l=a.beginFill("transparent").command,s=a.drawCircle(0,0,0).command,u=new createjs.Shape,c=p=new createjs.Container,c.visible=!1,c.addChild(u),c.addChild(n),c.addChild(r),t.addChild(p),this.stage.addChild(t),this.tick(function(e){var t,i,a,r,o;return t=e.timeStamp,t>d.$overloadTime&&t>d.$recoverTime?(p.visible||(i=createjs.Tween.get(p,{override:!0}),i.to({alpha:0,scaleX:.69,scaleY:.69,visible:!0}),i.to({y:0,alpha:1,scaleX:1,scaleY:1},3e3,createjs.Ease.elasticOut)),d.$xpPassing?l.style="rgba(128, 128, 128, 0.8)":l.style="transparent",s.radius=120*d.$xp/d.lv().xpMax,a=240*d.$hp/d.hpGoal(),r=u,o=r.graphics,o.clear(),o.beginFill("rgba(32, 32, 32, 0.8)"),o.rect(-120,120-a,240,a),r.mask=n,r):p.visible=!1})})}).call(this);
(function(){puddi(function(){var e,t,i,n=this;return e=18,t=new createjs.LoadQueue,i=e,(this.tutorial=function(a){var r,o,l,s;return null==a&&(a=n.$tutorial),a=Number(a),n.$tutorial=a,a>=0&&e>a?(i>a&&(t.loadManifest(function(){function e(){var e,t,n=[];for(e=a,t=i;t>e;++e)n.push(e);return n}var t,n,o,l=[];for(t=0,o=(n=e()).length;o>t;++t)r=n[t],l.push("img/tutorial/"+r+".png");return l}()),i=a),o=$("#tutorial-box"),o.length||(l=o=$('<a href id="tutorial-box">'),l.click(function(e){return e.preventDefault(),n.tutorial(++n.$tutorial)}),l.appendTo("#gaem")),s=o,s.css("background-image","url(img/tutorial/"+a+".png)"),s):void $("#tutorial-box").remove()})(),$("#help-link").click(function(e){return e.preventDefault(),n.tutorial(0)})})}).call(this);
(function(){var e,t,i,n,a;for(e={_:this},t=0,a=(n=this.puddi.mew).length;a>t;++t)i=n[t],i.call(e,e)}).call(this);
